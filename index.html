<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#9333ea">
    <title>ðŸ’ª Coach Girlie Pro Max ðŸ‘‘</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #9333ea 0%, #ec4899 50%, #9333ea 100%);
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .glass {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body class="text-white">
    <div id="root" class="min-h-screen flex flex-col max-w-2xl mx-auto"></div>

    <script type="module">
        import React, { useState, useEffect } from 'https://cdn.skypack.dev/react';
        import ReactDOM from 'https://cdn.skypack.dev/react-dom';

        function CoachGirlieApp() {
            // State declarations
            const [activeTab, setActiveTab] = useState('log');
            const [logs, setLogs] = useState([]);
            const [dayType, setDayType] = useState('');
            const [selectedMood, setSelectedMood] = useState('ðŸ¥³');
            const [fasted, setFasted] = useState(false);
            const [carbload, setCarbload] = useState(false);
            const [freshActivity, setFreshActivity] = useState('');
            const [brickActivities, setBrickActivities] = useState([]);
            const [currentMonth, setCurrentMonth] = useState(new Date());
            const [apiKey, setApiKey] = useState('');
            const [chatMessages, setChatMessages] = useState([]);
            const [chatInput, setChatInput] = useState('');
            const [spinData, setSpinData] = useState({
                time: '', ftpAvg: '', ftpMax: '', wattAvg: '', wattMax: '',
                bpmAvg: '', bpmMax: '', rpmAvg: '', rpmMax: '', kmhAvg: '', kmhMax: '',
                distance: '', calories: '', tss: '',
                intense: false, aerobic: false, dynamic: false, vo2: false
            });
            const [bbData, setBbData] = useState({
                time: '', bar: false, loose: false, bodyweight: false,
                warmup: '', squats: '', back: '', chest: '', triceps: '', biceps: '',
                lunges: '', shoulders: '', abs: '', bpmAvg: '', bpmMax: '',
                intense: false, aerobic: false, anaerobic: false, vo2: false
            });

            // Load data on start
            useEffect(() => {
                const savedLogs = localStorage.getItem('coach_girlie_logs');
                const savedKey = localStorage.getItem('coach_girlie_api_key');
                const savedChat = localStorage.getItem('coach_girlie_chat');
                if (savedLogs) setLogs(JSON.parse(savedLogs));
                if (savedKey) setApiKey(savedKey);
                if (savedChat) setChatMessages(JSON.parse(savedChat));
            }, []);

            // Save a new log
            const saveLog = () => {
                if (!dayType) {
                    alert('Please select a day type, Bestie! ðŸ‘‘');
                    return;
                }
                const newLog = {
                    date: new Date().toISOString().split('T')[0],
                    dayType,
                    mood: selectedMood,
                    fasted,
                    carbload,
                    activities: []
                };

                if (dayType === 'fresh' && freshActivity) {
                    if (freshActivity === 'spin') newLog.activities.push({ type: 'spin', ...spinData });
                    if (freshActivity === 'bodybump') newLog.activities.push({ type: 'bodybump', ...bbData });
                }
                if (dayType === 'brick') {
                    newLog.activities = [...brickActivities];
                }

                const updatedLogs = [...logs, newLog];
                setLogs(updatedLogs);
                localStorage.setItem('coach_girlie_logs', JSON.stringify(updatedLogs));
                alert('Logged, Queen! ðŸ’…');
                resetForm();
            };

            const resetForm = () => {
                setDayType('');
                setSelectedMood('ðŸ¥³');
                setFasted(false);
                setCarbload(false);
                setFreshActivity('');
                setBrickActivities([]);
                setSpinData({
                    time: '', ftpAvg: '', ftpMax: '', wattAvg: '', wattMax: '',
                    bpmAvg: '', bpmMax: '', rpmAvg: '', rpmMax: '', kmhAvg: '', kmhMax: '',
                    distance: '', calories: '', tss: '',
                    intense: false, aerobic: false, dynamic: false, vo2: false
                });
                setBbData({
                    time: '', bar: false, loose: false, bodyweight: false,
                    warmup: '', squats: '', back: '', chest: '', triceps: '', biceps: '',
                    lunges: '', shoulders: '', abs: '', bpmAvg: '', bpmMax: '',
                    intense: false, aerobic: false, anaerobic: false, vo2: false
                });
            };

            const addBrickActivity = () => {
                setBrickActivities([...brickActivities, { type: 'spin', time: '', bpm: '', notes: '' }]);
            };

            const updateBrickActivity = (index, field, value) => {
                const updated = [...brickActivities];
                updated[index][field] = value;
                setBrickActivities(updated);
            };

            const removeBrickActivity = (index) => {
                setBrickActivities(brickActivities.filter((_, i) => i !== index));
            };

            const sendChatMessage = async () => {
                if (!chatInput.trim()) return;
                if (!apiKey) {
                    alert('Enter your OpenAI key first, Diva! ðŸ”‘');
                    return;
                }

                const userMsg = { role: 'user', content: chatInput };
                const updatedMessages = [...chatMessages, userMsg];
                setChatMessages(updatedMessages);
                setChatInput('');

                try {
                    const response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${apiKey}`
                        },
                        body: JSON.stringify({
                            model: 'gpt-3.5-turbo',
                            messages: [
                                {
                                    role: 'system',
                                    content: `You are Coach Girlie, a sassy, supportive fitness coach. Call the user Bestie, Queen, or Diva. Be encouraging and hype them up based on their stats.`
                                },
                                ...updatedMessages
                            ]
                        })
                    });
                    const data = await response.json();
                    const aiMsg = { role: 'assistant', content: data.choices[0].message.content };
                    const finalMessages = [...updatedMessages, aiMsg];
                    setChatMessages(finalMessages);
                    localStorage.setItem('coach_girlie_chat', JSON.stringify(finalMessages));
                } catch (error) {
                    alert('Chat failed, Bestie! Check your key. ðŸ˜”');
                }
            };

            const calculatePRs = () => {
                const spinLogs = logs.flatMap(l => l.activities.filter(a => a.type === 'spin'));
                const bbLogs = logs.flatMap(l => l.activities.filter(a => a.type === 'bodybump'));
                const brickLogs = logs.filter(l => l.dayType === 'brick');

                return {
                    spinWatt: Math.max(...spinLogs.map(s => parseFloat(s.wattAvg) || 0), 0),
                    spinDistance: Math.max(...spinLogs.map(s => parseFloat(s.distance) || 0), 0),
                    spinTSS: Math.max(...spinLogs.map(s => parseFloat(s.tss) || 0), 0),
                    bbTracks: Math.max(...bbLogs.map(b => [b.warmup, b.squats, b.back, b.chest, b.triceps, b.biceps, b.lunges, b.shoulders, b.abs].filter(Boolean).length), 0),
                    brickActivities: Math.max(...brickLogs.map(b => b.activities.length), 0),
                    brickTime: Math.max(...brickLogs.flatMap(b => b.activities.map(a => parseFloat(a.time) || 0)), 0),
                    streak: logs.length > 0 ? 1 : 0
                };
            };

            const prs = calculatePRs();

            // UI Rendering
            return React.createElement('div', { className: 'flex flex-col min-h-screen' },
                // Header
                React.createElement('div', { className: 'glass p-4 text-center' },
                    React.createElement('h1', { className: 'text-3xl font-black uppercase tracking-wider' }, 'ðŸ’ª Coach Girlie Pro Max ðŸ‘‘')
                ),

                // Tabs
                React.createElement('div', { className: 'flex glass' },
                    [['log', 'LOG'], ['history', 'HISTORY'], ['pr', 'PR BOARD'], ['chat', 'CHAT']].map(([tab, label]) =>
                        React.createElement('button', {
                            key: tab,
                            onClick: () => setActiveTab(tab),
                            className: `flex-1 py-3 text-sm font-bold ${activeTab === tab ? 'bg-white bg-opacity-20 border-b-4 border-white' : 'opacity-60'}`
                        }, label)
                    )
                ),

                // Tab Content
                React.createElement('div', { className: 'flex-1 overflow-y-auto p-4 space-y-4' },
                    // LOG TAB
                    activeTab === 'log' && React.createElement('div', { className: 'space-y-4' },
                        // Day Type
                        React.createElement('div', { className: 'glass p-4 rounded-xl' },
                            React.createElement('label', { className: 'block font-bold text-sm mb-2 uppercase' }, 'Day Type'),
                            React.createElement('div', { className: 'flex gap-3' },
                                ['fresh', 'brick'].map(type =>
                                    React.createElement('label', { key: type, className: 'flex items-center gap-2 cursor-pointer' },
                                        React.createElement('input', {
                                            type: 'radio',
                                            checked: dayType === type,
                                            onChange: () => setDayType(type),
                                            className: 'w-5 h-5'
                                        }),
                                        React.createElement('span', { className: 'capitalize' }, type)
                                    )
                                )
                            )
                        ),

                        // Conditions
                        React.createElement('div', { className: 'glass p-4 rounded-xl' },
                            React.createElement('label', { className: 'block font-bold text-sm mb-2 uppercase' }, 'Conditions'),
                            React.createElement('div', { className: 'space-y-2' },
                                React.createElement('label', { className: 'flex items-center gap-2 cursor-pointer' },
                                    React.createElement('input', {
                                        type: 'checkbox',
                                        checked: fasted,
                                        onChange: (e) => setFasted(e.target.checked)
                                    }),
                                    'Fasted Training'
                                ),
                                React.createElement('label', { className: 'flex items-center gap-2 cursor-pointer' },
                                    React.createElement('input', {
                                        type: 'checkbox',
                                        checked: carbload,
                                        onChange: (e) => setCarbload(e.target.checked)
                                    }),
                                    'Carbload Evening Before'
                                )
                            )
                        ),

                        // Mood
                        React.createElement('div', { className: 'glass p-4 rounded-xl' },
                            React.createElement('label', { className: 'block font-bold text-sm mb-2 uppercase' }, 'Mood'),
                            React.createElement('div', { className: 'flex gap-2 justify-around' },
                                ['ðŸ˜ž', 'ðŸ˜', 'ðŸ™‚', 'ðŸ˜', 'ðŸ¥³'].map(mood =>
                                    React.createElement('button', {
                                        key: mood,
                                        onClick: () => setSelectedMood(mood),
                                        className: `text-4xl w-16 h-16 rounded-full bg-white bg-opacity-20 ${selectedMood === mood ? 'border-4 border-white scale-110' : ''}`
                                    }, mood)
                                )
                            )
                        ),

                        // Fresh Activity Selector
                        dayType === 'fresh' && React.createElement('div', { className: 'glass p-4 rounded-xl' },
                            React.createElement('label', { className: 'block font-bold text-sm mb-2 uppercase' }, 'Activity'),
                            React.createElement('div', { className: 'grid grid-cols-2 gap-3' },
                                [['spin', 'SPIN'], ['bodybump', 'BODYBUMP']].map(([act, label]) =>
                                    React.createElement('button', {
                                        key: act,
                                        onClick: () => setFreshActivity(act),
                                        className: `p-3 rounded-lg font-bold border-2 ${freshActivity === act ? 'bg-white bg-opacity-40 border-white' : 'bg-white bg-opacity-20 border-transparent'}`
                                    }, label)
                                )
                            )
                        ),

                        // SPIN Form
                        dayType === 'fresh' && freshActivity === 'spin' && React.createElement('div', { className: 'glass p-4 rounded-xl space-y-3' },
                            React.createElement('h3', { className: 'font-bold text-lg' }, 'Spin Session'),
                            React.createElement('input', {
                                type: 'number',
                                placeholder: 'Time (min)',
                                value: spinData.time,
                                onChange: (e) => setSpinData({...spinData, time: e.target.value}),
                                className: 'w-full p-2 rounded-lg bg-white text-gray-900'
                            }),
                            React.createElement('div', { className: 'grid grid-cols-2 gap-2' },
                                ['ftpAvg', 'ftpMax', 'wattAvg', 'wattMax', 'bpmAvg', 'bpmMax', 'rpmAvg', 'rpmMax', 'kmhAvg', 'kmhMax', 'distance', 'calories'].map(key =>
                                    React.createElement('input', {
                                        key,
                                        type: 'number',
                                        placeholder: key.replace(/([A-Z])/g, ' $1'),
                                        value: spinData[key],
                                        onChange: (e) => setSpinData({...spinData, [key]: e.target.value}),
                                        className: 'p-2 rounded-lg bg-white text-gray-900'
                                    })
                                )
                            ),
                            React.createElement('input', {
                                type: 'number',
                                placeholder: 'TSS',
                                value: spinData.tss,
                                onChange: (e) => setSpinData({...spinData, tss: e.target.value}),
                                className: 'w-full p-2 rounded-lg bg-white text-gray-900'
                            }),
                            React.createElement('div', null,
                                React.createElement('label', { className: 'font-bold text-xs uppercase' }, 'Effort Points'),
                                [['intense', 'Intense'], ['aerobic', 'Aerobic'], ['dynamic', 'Dynamic'], ['vo2', 'VO2 Max']].map(([key, label]) =>
                                    React.createElement('label', { key, className: 'flex items-center gap-2 cursor-pointer' },
                                        React.createElement('input', {
                                            type: 'checkbox',
                                            checked: spinData[key],
                                            onChange: (e) => setSpinData({...spinData, [key]: e.target.checked})
                                        }),
                                        label
                                    )
                                )
                            )
                        ),

                        // BODYBUMP Form
                        dayType === 'fresh' && freshActivity === 'bodybump' && React.createElement('div', { className: 'glass p-4 rounded-xl space-y-3' },
                            React.createElement('h3', { className: 'font-bold text-lg' }, 'Bodybump Session'),
                            React.createElement('input', {
                                type: 'number',
                                placeholder: 'Time (min)',
                                value: bbData.time,
                                onChange: (e) => setBbData({...bbData, time: e.target.value}),
                                className: 'w-full p-2 rounded-lg bg-white text-gray-900'
                            }),
                            React.createElement('div', null,
                                React.createElement('label', { className: 'font-bold text-xs uppercase' }, 'Weights Used'),
                                [['bar', 'Bar'], ['loose', 'Loose'], ['bodyweight', 'Bodyweight']].map(([key, label]) =>
                                    React.createElement('label', { key, className: 'flex items-center gap-2 cursor-pointer' },
                                        React.createElement('input', {
                                            type: 'checkbox',
                                            checked: bbData[key],
                                            onChange: (e) => setBbData({...bbData, [key]: e.target.checked})
                                        }),
                                        label
                                    )
                                )
                            ),
                            React.createElement('label', { className: 'font-bold text-xs uppercase' }, 'Track Breakdown'),
                            ['warmup', 'squats', 'back', 'chest', 'triceps', 'biceps', 'lunges', 'shoulders', 'abs'].map(track =>
                                React.createElement('input', {
                                    key: track,
                                    type: 'text',
                                    placeholder: track.charAt(0).toUpperCase() + track.slice(1),
                                    value: bbData[track],
                                    onChange: (e) => setBbData({...bbData, [track]: e.target.value}),
                                    className: 'w-full p-2 rounded-lg bg-white text-gray-900'
                                })
                            ),
                            React.createElement('div', { className: 'grid grid-cols-2 gap-2' },
                                React.createElement('input', {
                                    type: 'number',
                                    placeholder: 'BPM Avg',
                                    value: bbData.bpmAvg,
                                    onChange: (e) => setBbData({...bbData, bpmAvg: e.target.value}),
                                    className: 'p-2 rounded-lg bg-white text-gray-900'
                                }),
                                React.createElement('input', {
                                    type: 'number',
                                    placeholder: 'BPM Max',
                                    value: bbData.bpmMax,
                                    onChange: (e) => setBbData({...bbData, bpmMax: e.target.value}),
                                    className: 'p-2 rounded-lg bg-white text-gray-900'
                                })
                            ),
                            React.createElement('div', null,
                                React.createElement('label', { className: 'font-bold text-xs uppercase' }, 'Effort'),
                                [['intense', 'Intense'], ['aerobic', 'Aerobic'], ['anaerobic', 'Anaerobic'], ['vo2', 'VO2 Max']].map(([key, label]) =>
                                    React.createElement('label', { key, className: 'flex items-center gap-2 cursor-pointer' },
                                        React.createElement('input', {
                                            type: 'checkbox',
                                            checked: bbData[key],
                                            onChange: (e) => setBbData({...bbData, [key]: e.target.checked})
                                        }),
                                        label
                                    )
                                )
                            )
                        ),

                        // BRICK Activities
                        dayType === 'brick' && React.createElement('div', { className: 'space-y-3' },
                            brickActivities.map((act, idx) =>
                                React.createElement('div', { key: idx, className: 'glass p-4 rounded-xl relative' },
                                    React.createElement('button', {
                                        onClick: () => removeBrickActivity(idx),
                                        className: 'absolute top-2 right-2 bg-pink-600 text-white rounded-full w-8 h-8 font-bold'
                                    }, 'Ã—'),
                                    React.createElement('select', {
                                        value: act.type,
                                        onChange: (e) => updateBrickActivity(idx, 'type', e.target.value),
                                        className: 'w-full p-2 rounded-lg bg-white text-gray-900 mb-2'
                                    },
                                        React.createElement('option', { value: 'spin' }, 'Spin'),
                                        React.createElement('option', { value: 'bodypump' }, 'Bodypump'),
                                        React.createElement('option', { value: 'yin' }, 'Yin Yoga'),
                                        React.createElement('option', { value: 'pilates' }, 'Mat Pilates')
                                    ),
                                    React.createElement('input', {
                                        type: 'number',
                                        placeholder: 'Time (min)',
                                        value: act.time,
                                        onChange: (e) => updateBrickActivity(idx, 'time', e.target.value),
                                        className: 'w-full p-2 rounded-lg bg-white text-gray-900 mb-2'
                                    }),
                                    React.createElement('input', {
                                        type: 'number',
                                        placeholder: 'BPM',
                                        value: act.bpm,
                                        onChange: (e) => updateBrickActivity(idx, 'bpm', e.target.value),
                                        className: 'w-full p-2 rounded-lg bg-white text-gray-900'
                                    })
                                )
                            ),
                            React.createElement('button', {
                                onClick: addBrickActivity,
                                className: 'w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-3 rounded-full font-bold uppercase'
                            }, '+ Add Activity')
                        ),

                        // SAVE BUTTON
                        React.createElement('button', {
                            onClick: saveLog,
                            className: 'w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-4 rounded-full font-bold uppercase text-lg shadow-lg mt-4'
                        }, 'ðŸ’¾ Save Log')
                    ),

                    // HISTORY TAB
                    activeTab === 'history' && React.createElement('div', null,
                        React.createElement('div', { className: 'glass p-4 rounded-xl mb-4 flex justify-between items-center' },
                            React.createElement('button', {
                                onClick: () => setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1)),
                                className: 'bg-white bg-opacity-30 px-4 py-2 rounded-lg font-bold'
                            }, 'â†'),
                            React.createElement('span', { className: 'font-bold' }, currentMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })),
                            React.createElement('button', {
                                onClick: () => setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1)),
                                className: 'bg-white bg-opacity-30 px-4 py-2 rounded-lg font-bold'
                            }, 'â†’')
                        ),
                        React.createElement('div', { className: 'grid grid-cols-7 gap-2' },
                            ['S', 'M', 'T', 'W', 'T', 'F', 'S'].map(day =>
                                React.createElement('div', { key: day, className: 'text-center font-bold text-sm' }, day)
                            ),
                            // Calendar days would go here
                            Array.from({ length: 31 }, (_, i) =>
                                React.createElement('div', {
                                    key: i,
                                    className: 'aspect-square bg-white bg-opacity-15 rounded-lg flex items-center justify-center'
                                }, i + 1)
                            )
                        )
                    ),

                    // PR BOARD TAB
                    activeTab === 'pr' && React.createElement('div', { className: 'space-y-4' },
                        ['Spin Records', 'Bodybump Records', 'Brick Records', 'General'].map(section =>
                            React.createElement('div', { key: section, className: 'glass p-4 rounded-xl' },
                                React.createElement('h3', { className: 'text-lg font-bold mb-3 uppercase' }, section),
                                React.createElement('div', { className: 'space-y-2' },
                                    // Placeholder PR items
                                    ['Record 1', 'Record 2', 'Record 3'].map(item =>
                                        React.createElement('div', { key: item, className: 'bg-black bg-opacity-20 p-3 rounded-lg' }, `${item}: --`)
                                    )
                                )
                            )
                        )
                    ),

                    // CHAT TAB
                    activeTab === 'chat'
```
